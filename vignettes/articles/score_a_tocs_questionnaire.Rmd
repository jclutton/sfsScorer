---
title: "Score a TOCS-2 Questionnaire"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

The Toronto Obsessive-Compulsive Scale 2 (TOCS-2) is a validated instrument for measuring Obsessive-Compulsive (OCD) traits. This article shows you how to score your TOCS-2 tests.

## Quick Start

```{r, echo = FALSE, message = FALSE, warning=FALSE}
# This is used to keep random data consistent
set.seed(1)

# Number of random participants to generate
pt_num <- 5

# Generate all of the tocs2 data. Variables should be named tocs1 to tocs24, corresponding to each question on the tocs2.
tocs2_sample <- as.data.frame(matrix(round(runif(n=pt_num*24, min=-3, max=3), 0), nrow=pt_num)) |> 
  setNames(c(paste0('tocs',seq(from = 1, to = 24, by = 1))))

# Import your data. In this example, we will use random data.
random_data <- data.frame(age = sample(5:18, size = pt_num), # age must be between 5 and 18 
                          gender = sample(1:2, size = pt_num, replace = TRUE)) |>  # gender where 1 = boy and 2 = girl. 
                          #Both gendered and non-gendered t-scores are generated. If a participant is gender-diverse, use the non-gendered t-scores.
  dplyr::mutate(p_respondent = 1) |>  # p_respondent stands for parent respondent. 1 for yes, 0 for no
  dplyr::bind_cols(tocs2_sample)

```

The code below shows how to score a TOCS-2 questionnaire using the `score_tocs2()` function.


```{r}
library(sfsScorer)

#' Here's how we expect the data to be formatted
#' age (5-18)
#' gender (1 = boy, 2 = girl)
#' p_respondent (1 = parent / caregiver responded, 0 = child / youth respondent)
#' All tocs questions 1-24 as tocs1...tocs24
head(random_data, 1)

# Score from a data frame
scores <- score_tocs2(df = random_data)

# OR
# Score from a a csv or xlsx file
tocs_csv <- system.file("extdata", "sample_tocs.csv", package = "sfsScorer")
scores_csv <- score_tocs2(file = tocs_csv)

# Data are validated by default
 df_mod <- random_data |> 
   dplyr::mutate(tocs1 = 6)
 try(scores_csv <- score_tocs2(df = df_mod))
 
 # To ignore validation and introduce NAs use `ignore_check = TRUE`. 
 # This can impact scoring
 scores_csv <- score_tocs2(df = df_mod, ignore_check = TRUE)
 
 # Allow more missingness
 # This will use prorated scores
  scores_csv <- score_tocs2(df = df_mod, ignore_check = TRUE, max_missing = 1)


```

## Notes Before Starting

-   T-scores will be generated based on gendered and non-gendered norms. Please feel free to include children who are trans or non-binary in your dataset and leave the codes for their gender as appropriate for the individuals in your study. Non-gendered t-scores will be generated for all individuals. Gendered t-scores will only be generated when gender is coded as 1 or 2. It is recommended to use the non-gendered t-scores for trans or non-binary individuals.

## Instructions

### Formatting Your Data

Our first step is to prepare your raw TOCS-2 data.

1.  Prepare a spreadsheet, preferably a .csv file, with a row for each of the tests you'd like to score.

2.  Be sure the following columns are present in the spreadsheet and rename the columns to match the reference guide below. All of the following columns are necessary for the model. If age or p_respondent are missing from a row, the model will not return a t-score for that row.

    <div>

    | Column Name | Additional Information | Example |
    |-------------------|-----------------------------------|------------------|
    | age | The child's age | 5 - 18 <br><br> Note: Age in a numeric form, i.e. with decimals, will provide a more accurate t-score compared to an integer-based age |
    | gender | The child's gender. Please feel free to include children who are trans or non-binary in your dataset and leave the codes for their gender as appropriate for the individuals in your study. Non-gendered t-scores will be generated for all individuals. To generate gendered t-scores for binary gendered participants be sure to code gender as 1 = boy and 2 = girl | 1 = Boy, 2 = Girl <br><br> Note: Any gender not coded as 1 or 2 will not receive a gendered t-score. |
    | p_respondent | Whether the survey was filled out by the parent or the child | 1 = Parent / Caregiver Respondent, 0 = Child / Youth Self-Respondent |
    | tocs1 | TOCS-2 Question #1 | -3 (Far Below) to 3 (Far Above) |
    | tocs2 | TOCS-2 Question #2 | -3 (Far Below) to 3 (Far Above) |
    | tocs3 | TOCS-2 Question #3 | -3 (Far Below) to 3 (Far Above) |
    | tocs4 | TOCS-2 Question #4 | -3 (Far Below) to 3 (Far Above) |
    | tocs5 | TOCS-2 Question #5 | -3 (Far Below) to 3 (Far Above) |
    | tocs6 | TOCS-2 Question #6 | -3 (Far Below) to 3 (Far Above) |
    | tocs7 | TOCS-2 Question #7 | -3 (Far Below) to 3 (Far Above) |
    | tocs8 | TOCS-2 Question #8 | -3 (Far Below) to 3 (Far Above) |
    | tocs9 | TOCS-2 Question #9 | -3 (Far Below) to 3 (Far Above) |
    | tocs10 | TOCS-2 Question #10 | -3 (Far Below) to 3 (Far Above) |
    | tocs11 | TOCS-2 Question #11 | -3 (Far Below) to 3 (Far Above) |
    | tocs12 | TOCS-2 Question #12 | -3 (Far Below) to 3 (Far Above) |
    | tocs13 | TOCS-2 Question #13 | -3 (Far Below) to 3 (Far Above) |
    | tocs14 | TOCS-2 Question #14 | -3 (Far Below) to 3 (Far Above) |
    | tocs15 | TOCS-2 Question #15 | -3 (Far Below) to 3 (Far Above) |
    | tocs16 | TOCS-2 Question #16 | -3 (Far Below) to 3 (Far Above) |
    | tocs17 | TOCS-2 Question #17 | -3 (Far Below) to 3 (Far Above) |
    | tocs18 | TOCS-2 Question #18 | -3 (Far Below) to 3 (Far Above) |
    | tocs19 | TOCS-2 Question #19 | -3 (Far Below) to 3 (Far Above) |
    | tocs20 | TOCS-2 Question #20 | -3 (Far Below) to 3 (Far Above) |
    | tocs21 | TOCS-2 Question #21 | -3 (Far Below) to 3 (Far Above) |
    | tocs22 | TOCS-2 Question #22 | -3 (Far Below) to 3 (Far Above) |
    | tocs23 | TOCS-2 Question #23 | -3 (Far Below) to 3 (Far Above) |
    | tocs24 | TOCS-2 Question #24 | -3 (Far Below) to 3 (Far Above) |


    </div>

### Generate Scores

Use the code below to generate your t-scores. First, you will be prompted to select your file. Second, we will check that your data are formatted properly. Third, t-scores will be generated. 

If you receive an error, please correct the issue in your file, save your file, then run the `score_tocs2()` function again.

```{r example, eval = FALSE}
library(sfsScorer)

# The score_tocs2 function checks that your data are formatted correctly and generates the t-scores
tocs <- score_tocs2()
```

### Additional options

You have the option to...

```{r example2, eval=FALSE}

# Score from a data.frame in case the data do not exist in a csv file
tocs <- score_tocs2(df = tocs)

# Specify the input file
tocs <- score_tocs2(file = here("test_scores.csv"))

# Export results to an output folder
tocs <- score_tocs2(output_folder = file.path("C:","Users",..."yourpath"))

# Change the number of allowed missingness. 
# Default missinness is 0 questions. You can use the max_missing variable to allow more missingness
# Doing so will use a prorated score to generate a t-score. This can produce outliers and issues
tocs <- score_tocs2(file = here("test_scores.csv"), max_missing = 2)

```

## Understanding the Output

### Summary Values

| Column | Description |
|------------------------------------|------------------------------------|
| tocs_tot | A summed score of the answered questions |
| tocs_miss | A count of missing values across |
| tocs_pro | A prorated score by dividing swan_tot by the number of answered questions |


### T-scores 

| Column | Description |
|------------------------------------|------------------------------------|
| tocs_gender_tscores | A t-score normed to the Spit for Science sample that adjusts for age, respondent, and gender |
| tocs_tscores | A t-score  normed to the Spit for Science that adjusts for age and respondent |
